apiVersion: workspace.devfile.io/v1alpha2
kind: DevWorkspace
metadata:
  name: vscode-redhat-only
spec:
  started: true
  template:
    components:
      # VS Code editor definition
      - name: vscode
        container:
          image: quay.io/devfile/universal-developer-image:latest
          memoryLimit: 2Gi
          mountSources: true
          volumeMounts:
            - name: extensions
              path: /home/user/.vscode/extensions
          env:
            # Restrict extensions to only RedHat
            - name: EXTENSIONS_GALLERY
              value: '{"serviceUrl": "", "allowedExtensions": ["redhat.*"]}'
            # Disable all other extension sources
            - name: CHE_CODE__EXTENSIONS_GALLERY__ENABLED
              value: "false"

    # Empty project definition


    # Volumes for extension storage
    volumes:
      - name: extensions
        ephemeral: false
        size: 1Gi

    # Editor selection
    attributes:
      editor: che-incubator/che-code/latest
      plugins:
        - editor: che-incubator/che-code/latest
          cpuLimit: 500m
          memoryLimit: 256Mi